@{
    ViewData["Title"] = @Model.Name;
}
@section Styles{
<style>
    body {
        background-color: #FAFAFA;
    }
</style>
}

@model InstagramUser;



<section class="header">
    <div class="container">
        <div class="row">
            <div class="col-lg-4 col-md-6 col-sm-12">
                <img src="~/Uploads/@Model.Photo " class="img-thumbnail img-profiles" />
            </div>

            <div class="col-lg-8 col-md-6 col-sm-12">
                <div class="form-group ProfileName">
                    <span> <h3> @Model.Name </h3> </span>
                    <button class="btn btn-outline-primary btned" type="button" data-toggle="modal" data-target="#EditProfilo">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-gear-wide" viewBox="0 0 16 16">
                            <path d="M8.932.727c-.243-.97-1.62-.97-1.864 0l-.071.286a.96.96 0 0 1-1.622.434l-.205-.211c-.695-.719-1.888-.03-1.613.931l.08.284a.96.96 0 0 1-1.186 1.187l-.284-.081c-.96-.275-1.65.918-.931 1.613l.211.205a.96.96 0 0 1-.434 1.622l-.286.071c-.97.243-.97 1.62 0 1.864l.286.071a.96.96 0 0 1 .434 1.622l-.211.205c-.719.695-.03 1.888.931 1.613l.284-.08a.96.96 0 0 1 1.187 1.187l-.081.283c-.275.96.918 1.65 1.613.931l.205-.211a.96.96 0 0 1 1.622.434l.071.286c.243.97 1.62.97 1.864 0l.071-.286a.96.96 0 0 1 1.622-.434l.205.211c.695.719 1.888.03 1.613-.931l-.08-.284a.96.96 0 0 1 1.187-1.187l.283.081c.96.275 1.65-.918.931-1.613l-.211-.205a.96.96 0 0 1 .434-1.622l.286-.071c.97-.243.97-1.62 0-1.864l-.286-.071a.96.96 0 0 1-.434-1.622l.211-.205c.719-.695.03-1.888-.931-1.613l-.284.08a.96.96 0 0 1-1.187-1.186l.081-.284c.275-.96-.918-1.65-1.613-.931l-.205.211a.96.96 0 0 1-1.622-.434L8.932.727zM8 12.997a4.998 4.998 0 1 1 0-9.995 4.998 4.998 0 0 1 0 9.996z" />
                        </svg>
                    </button>
                </div>

                <div class="form-group ProfileBio">
                    <p>@Model.Bio</p>
                </div>

                <div class="form-group Follwing">

                    <span class="-nal3 ">
                        <span class="g47SY ">0</span> posts
                    </span>

                    <a class="-nal3 " href="#" tabindex="0">
                        <span class="g47SY " title="19">19</span> followers
                    </a>

                    <a class="-nal3 " href="#" tabindex="0">
                        <span class="g47SY ">542</span> following
                    </a>
                </div>
            </div>


            <div id="TabPosts" class="col-lg-12">
                <hr />
                <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
                    <li class="nav-item" role="presentation">
                        <a class="nav-link active" id="pills-home-tab" data-toggle="pill" href="#pills-post" role="tab" aria-controls="pills-home" aria-selected="true">Posts</a>
                    </li>
                    <li class="nav-item" role="presentation">
                        <a class="nav-link" id="pills-profile-tab" data-toggle="pill" href="#pills-2 role="tab" aria-controls="pills-profile" aria-selected="false">Profile</a>
                    </li>
                    <li class="nav-item" role="presentation">
                        <a class="nav-link" id="pills-contact-tab" data-toggle="pill" href="#pills-con" role="tab" aria-controls="pills-contact" aria-selected="false">Contact</a>
                    </li>
                </ul>
                <div class="tab-content" id="pills-tabContent">
                    <div class="tab-pane fade show active" id="pills-post" role="tabpanel" aria-labelledby="pills-post-tab">
                        <!-- Button trigger modal -->
                        <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#staticBackdrop">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-plus-circle" viewBox="0 0 16 16">
                                <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
                                <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z" />
                            </svg>
                            New Post
                        </button>

                    </div>
                    <div class="tab-pane fade" id="pills-2" role="tabpanel" aria-labelledby="pills-2-tab">...</div>
                    <div class="tab-pane fade" id="pills-con" role="tabpanel" aria-labelledby="pills-con-tab">...</div>
                </div>

            </div>
        </div>
    </div>
</section>

<hr />



<!-- Modal change Password -->
<div class="modal fade" id="EditProfilo" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Edit Profile</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">

                <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
                    <li class="nav-item" role="presentation">
                        <a class="nav-link active" id="pills-home-tab" data-toggle="pill" href="#pills-home" role="tab" aria-controls="pills-home" aria-selected="true">General Info</a>
                    </li>
                    <li class="nav-item" role="presentation">
                        <a class="nav-link" id="pills-profile-tab" data-toggle="pill" href="#pills-profile" role="tab" aria-controls="pills-profile" aria-selected="false">Password</a>
                    </li>

                </ul>
                <div class="tab-content" id="pills-tabContent">
                    @*Tab_1*@
                    <div class="tab-pane fade show active" id="pills-home" role="tabpanel" aria-labelledby="pills-home-tab">
                        <form method="post" asp-controller="Profiles" asp-action="EditProfile">
                            <div class="modal-body">

                                <div class="form-group">
                                    <label> Name : </label>
                                    <input class="form-control" name="Name" id="Name" value="@Model.Name" />
                                </div>

                                <div class="form-group">
                                    <label> Bio : </label>
                                    <textarea name="Bio" id="Bio" class="form-control">@Model.Bio</textarea>

                                </div>

                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                    <button type="submit" class="btn btn-primary">Save changes</button>
                                </div>
                            </div>
                        </form>
                    </div>

                    @*Tab_2*@
                    <div class="tab-pane fade" id="pills-profile" role="tabpanel" aria-labelledby="pills-profile-tab">
                        <div class="form-group">
                            <label> Current Password : </label>
                            <input class="form-control" type="password" autocomplete="new-password" id="OldPass" oninput="removeerror(OldPass , TextOldPass)" />
                            <p class="text-danger" style="font-size:9px; display:none" id="TextOldPass">
                                Current Password Is Required
                            </p>
                        </div>
                        <div class="form-group">
                            <label> New Password : </label>
                            <input class="form-control" type="password" autocomplete="off" id="NewPass" oninput="removeerror(NewPass , TextNewPass)" />
                            <p class="text-danger" style="font-size:9px; display:none" id="TextNewPass">
                                New Password Must br Bigger than 6 Character
                            </p>
                        </div>
                        <div class="form-group">
                            <label> Confirm Password : </label>
                            <input class="form-control" type="password" autocomplete="off" id="ConfirmPass" oninput="removeerror(ConfirmPass , TextConfirmPass)" />
                            <p class="text-danger" style="font-size:9px; display:none" id="TextConfirmPass">
                                New Password Not Equal the Confirm Password .
                            </p>
                        </div>

                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                            <button id="ChangePassword" class="btn btn-primary">Save changes</button>
                        </div>
                    </div>
                </div>




            </div>

        </div>
    </div>
</div>

<!-- Modal Create Post -->
<div class="modal fade" id="staticBackdrop" data-backdrop="static" data-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="staticBackdropLabel">Create New Post</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <table>
                    <tr>
                        <td rowspan="2"><img src="~/Uploads/@Model.Photo " class="img-thumbnail img-profiles" style="width:36px; height:36px; border-radios:50%" /></td>
                        <td>@Model.Name</td>
                    </tr>

                </table>
                <textarea class="TextareaCreatePost" placeholder="What Are You Thinking .... " rows="6" id="desc"></textarea>

                <button class="btn btn-secondary" id="ChooseImagePostbtn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-camera" viewBox="0 0 16 16">
                        <path d="M15 12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V6a1 1 0 0 1 1-1h1.172a3 3 0 0 0 2.12-.879l.83-.828A1 1 0 0 1 6.827 3h2.344a1 1 0 0 1 .707.293l.828.828A3 3 0 0 0 12.828 5H14a1 1 0 0 1 1 1v6zM2 4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2h-1.172a2 2 0 0 1-1.414-.586l-.828-.828A2 2 0 0 0 9.172 2H6.828a2 2 0 0 0-1.414.586l-.828.828A2 2 0 0 1 3.172 4H2z" />
                        <path d="M8 11a2.5 2.5 0 1 1 0-5 2.5 2.5 0 0 1 0 5zm0 1a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7zM3 6.5a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0z" />
                    </svg>
                </button>
                <p class="text-danger" style="display:none; font-size:9px; margin-top:10px" id="ExError">
                    You Must Select Files with *.png or * .jpg or *.jpeg
                </p>
                <input style="display:none" type="file" id="ChooseImagePost" />
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x-circle-fill" viewBox="0 0 16 16">
                        <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293 5.354 4.646z" />
                    </svg>
                    Close
                </button>
                <button type="button" id="upload" class="btn btn-primary">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-share-fill" viewBox="0 0 16 16">
                        <path d="M11 2.5a2.5 2.5 0 1 1 .603 1.628l-6.718 3.12a2.499 2.499 0 0 1 0 1.504l6.718 3.12a2.5 2.5 0 1 1-.488.876l-6.718-3.12a2.5 2.5 0 1 1 0-3.256l6.718-3.12A2.5 2.5 0 0 1 11 2.5z" />
                    </svg>
                    Share
                </button>
            </div>
        </div>
    </div>
</div>


@section Scripts{
<script>


       function removeerror(input , p){
           input.classList.remove("inputError");
           p.style.display = "none";
       };

       $("#ChooseImagePostbtn").on("click", function () {
           document.getElementById("ChooseImagePost").click();
       })

       $("#ChooseImagePost").on("change" , function () {
           var u = $("#ChooseImagePost").get(0);

           for(var i = 0; i < u.files.Length; i++){
               if(u.files[i].name.indexOf('.jpg') <= 0 && u.files[i].name.indexOf('.jpeg') <= 0 && u.files[i].name.indexOf('.png') <= 0 )
               document.getElementById("ExError").style.display = "block";
               document.getElementById("upload").classList.add("disabled");
               break;
           }else{
               document.getElementById("ExError").style.display = "none";
               document.getElementById("upload").classList.remove("disabled");

           }
       });

       $("#upload").on("click", function () {
          if(!document.getElementById("upload").classList.contains('disabled')){
              var df = new FormData();

              df.append("desc" , document.getElementById("desc").value);
              var u = $("#ChooseImagePost").get(0);       
              for(var i = 0; i < u.files.Length; i++){
                  df.append("ChooseImagePost" , u.files[i]);
              }

              $.ajax({
                  url :'/Posts/uploadPost',
                  type :'post',
                  processData : false,
                  contentType : false,
                  data : df,
                  success : function () {
                      $("#EditProfilo").modal('hide');
                  }
              })
          }
       })

</script>
<script>
    $("#ChangePassword").on("click", function () {
        var Oldpassword = document.getElementById("OldPass");
        var Newpassword = document.getElementById("NewPass");
        var Confirmpassword = document.getElementById("ConfirmPass");

        if (Oldpassword.value.replace(' ', '') == '') {
            Oldpassword.classList.add("inputError");
            document.getElementById("TextOldPass").style.display = "block";
            return false;
        }

        if (Newpassword.value.Length < 6 ) {
            Newpassword.classList.add("inputError");
            document.getElementById("TextNewPass").style.display = "block";
            return false;
        }

        if (Confirmpassword.value != Newpassword.value) {
            Newpassword.classList.add("inputError");
            Confirmpassword.classList.add("inputError");
            document.getElementById("TextConfirmPass").style.display = "block";
            return false;
        }

        $.ajax({
            url : '/Profiles/ChangePassword',
            type : 'post',
            data :{ Oldpassword : Oldpassword.value , Newpassword : Newpassword.value},
            success : function (Result){
                if(Boolean(Result) == true)
                alert ("Change Password Success");
                $("#EditProfilo").modal('hide');
            } else {
                Oldpassword.classList.add("inputError");
            }
        }
        });
    });

    $("#ChooseImagePostbtn").on("click", function () {
        document.getElementById("ChooseImagePost").click();
    })

</script>
}